---
- include: set_hostname.yaml
- hosts: all
  become: yes
  tasks:
#      - name: Install puppetlabs repositories
#        apt:
#          deb: "http://apt.puppetlabs.com/puppet-release-{{ ansible_distribution_release }}.deb"
      - name: Install PuppetLabs release DEB for Debian derivates
        apt: pkg=puppet state={{ item }} update_cache=yes
        with_items:
        - "http://apt.puppetlabs.com/puppet-release-{{ ansible_distribution_release }}.deb"
        when: ansible_os_family == 'Debian'
        tags:
         - repo
         - install
         - packages
      - name: Install puppets correct version
        apt: name=puppet state=present update_cache=yes
      - name: Render puppet configuration file
        template: dest=/etc/puppet/puppet.conf src=puppet.conf.j2

# # important
  # playbook command with sudo
